#!/bin/bash
 
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --mem-per-cpu=40G
#SBATCH --time=3-0:00:00
#SBATCH --output=logs/DTMatrix%j.stdout
#SBATCH --mail-user=andrea.gillespie@petermac.org
#SBATCH --mail-type=END,TIME_LIMIT_80
#SBATCH --job-name="DTMatrix"
#SBATCH --partition=prod

module load deeptools/3.5.0

computeMatrix scale-regions -S \
alignment/RPGCNormBW/MHC-CSCR04-K562-CAS-MLL1_S12.bw alignment/RPGCNormBW/MHC-CSCR04-K562-MEN1c4-MLL1_S13.bw \
alignment/RPGCNormBW/MHC-CSCR01-K562-CAS-MLL1_S2.bw alignment/RPGCNormBW/MHC-CSCR01-K562-MEN1c4-KO-MLL1_S7.bw \
../ChIPseq_220303_NB501056_0768_AHMTHWBGXL/alignment/BW_RPGC_norm/MHC-CS22-K562-DMSO-MLL1_S1.RPGC.bw ../ChIPseq_220303_NB501056_0768_AHMTHWBGXL/alignment/BW_RPGC_norm/MHC-CS22-K562-VTP-MLL1_S2.RPGC.bw \
../ChIPseq_220303_NB501056_0768_AHMTHWBGXL/alignment/BW_RPGC_norm/MHC-CS22-K562-CAS-MLL1_S5.RPGC.bw ../ChIPseq_220303_NB501056_0768_AHMTHWBGXL/alignment/BW_RPGC_norm/MHC-CS22-K562-MEN1-KO-MLL1_S6.RPGC.bw \
../ChIPseq_200320_NB501056_0470_AH5NJJBGXF/RPGCNormBW/Cas_S2.bw ../ChIPseq_200320_NB501056_0470_AH5NJJBGXF/RPGCNormBW/MENKO_S4.bw ../ChIPseq_200320_NB501056_0470_AH5NJJBGXF/RPGCNormBW/MENi_S3.bw \
../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-CAS-H3K27me3_S6.RPGC.bw ../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-MEN1ko-H3K27me3_S7.RPGC.bw \
../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-CAS-H3K4me3_S2.RPGC.bw ../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-MEN1ko-H3K4me3_S3.RPGC.bw \
../ChIPseq_210623_NB501056_0652_AHTHVNBGXJ/RPGCNormBW/CS05-CAS-H3K4me3_S2.bw ../ChIPseq_210623_NB501056_0652_AHTHVNBGXJ/RPGCNormBW/CS05-MEN1c4-H3K4me3_S3.bw \
../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-CAS-H2AK119_S10.RPGC.bw ../CUTandTAG_220201_NB501056_0753_AHLHYCBGXL/alignment/BW_RPGC_norm/MHC-CSCT03-K562-MEN1ko-H2AK119_S11.RPGC.bw \
alignment/RPGCNormBW/MHC-CSCR01-K562-CAS-SUZ12_S3.bw alignment/RPGCNormBW/MHC-CSCR01-K562-MEN1c4-KO-SUZ12_S8.bw \
../ChIPseq_210422_NB501056_0625_AHGNFTBGXJ/RPGCNormBW/MHC-CS04-K562-3B-DUAL-SUZ12_S7.bw ../ChIPseq_210422_NB501056_0625_AHGNFTBGXJ/RPGCNormBW/MHC-CS04-K562-4B-DUAL-SUZ12_S8.bw \
alignment/RPGCNormBW/MHC-CSCR04-K562-CAS-RING1B_S16.bw alignment/RPGCNormBW/MHC-CSCR04-K562-MEN1c4-RING1B_S17.bw \
-R reference_files/diff_MLL_MENKO.bed reference_files/diff_MLL_common.bed reference_files/diff_MLL_CAS.bed -a 3000 -b 3000 -m 5000 -o All_Exp_DT_matrices/All_Exp_Cov_matrix_RPCGNorm_3cat_MLL1_FC.gz

#CSCR01
plotProfile -m All_Exp_DT_matrices/All_Exp_Cov_matrix_RPCGNorm_3cat_MLL1_FC.gz --perGroup --samplesLabel \
CSCR04-CAS-MLL1 CSCR04-MEN1c4-MLL1 \
CSCR01-CAS-MLL1 CSCR01-MEN1c4-KO-MLL1 \
CS22-DMSO-MLL1 CS22-VTP-MLL1 \
CS22-CAS-MLL1 CS22-MEN1-KO-MLL1 \
200320-CAS 200320-MENKO 200320-MENi \
CSCT03-CAS-H3K27me3 CSCT03-MEN1ko-H3K27me3 \
CSCT03-CAS-H3K4me3 CSCT03-MEN1ko-H3K4me3 \
CS05-CAS-H3K4me3 CS05-MEN1c4-H3K4me3 \
CSCT03-CAS-H2AK119 CSCT03-MEN1ko-H2AK119 \
CSCR01-CAS-SUZ12 CSCR01-MEN1c4-KO-SUZ12 \
CS04-CAS-SUZ12 CS04-KO-SUZ12 \
CSCR04-CAS-RING1B CSCR04-MEN1c4-RING1B \
--regionsLabel "MENKO" "Common" "CAS" \
-o plots/Profile_All_Exp_RPGCnorm_3cat_MLL1_FC.pdf --plotTitle "Cut&Run CSCR04 MLL1 bdgdiff"

plotHeatmap -m All_Exp_DT_matrices/All_Exp_Cov_matrix_RPCGNorm_3cat_MLL1_FC.gz --sortUsing sum --boxAroundHeatmaps no --samplesLabel \
CSCR04-CAS-MLL1 CSCR04-MEN1c4-MLL1 \
CSCR01-CAS-MLL1 CSCR01-MEN1c4-KO-MLL1 \
CS22-DMSO-MLL1 CS22-VTP-MLL1 \
CS22-CAS-MLL1 CS22-MEN1-KO-MLL1 \
200320-CAS 200320-MENKO 200320-MENi \
CSCT03-CAS-H3K27me3 CSCT03-MEN1ko-H3K27me3 \
CSCT03-CAS-H3K4me3 CSCT03-MEN1ko-H3K4me3 \
CS05-CAS-H3K4me3 CS05-MEN1c4-H3K4me3 \
CSCT03-CAS-H2AK119 CSCT03-MEN1ko-H2AK119 \
CSCR01-CAS-SUZ12 CSCR01-MEN1c4-KO-SUZ12 \
CS04-CAS-SUZ12 CS04-KO-SUZ12 \
CSCR04-CAS-RING1B CSCR04-MEN1c4-RING1B \
--regionsLabel "MENKO" "Common" "CAS" \
-o plots/Heatmap_All_Exp_RPGCnorm_3cat_MLL1_FC.pdf --plotTitle "Cut&Run CSCR04 MLL1 bdgdiff"
